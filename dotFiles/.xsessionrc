#!/bin/bash

# MESA_VK_DEVICE_SELECT=list zed --foreground

AMD_GPU_ID="1002:150e"
PRIMARY_GPU_NAME=$(xrandr --listproviders | awk '/Provider 0/ {print $NF}')

if [[ "$PRIMARY_GPU_NAME" == *"NVIDIA"* ]]; then
  unset MESA_VK_DEVICE_SELECT
else
  export MESA_VK_DEVICE_SELECT="$AMD_GPU_ID"
fi